# frost-page-title
The frost-page-title `addon` primarily provides a `Service` that automatically generates titles based on the url and a `Mixin` that provides an interface for extending or overriding this behavior.

* [Basic Usage](#basic-usage)
* [Initializers](#initializers)
* [Mixin](#mixin)
* [Service](#service)
* [Examples](#examples)

## Basic Usage
The simplest way to use the frost-page-title `addon` is to add __ember-frost-page-title__ to your `package.json` file and set your app's default title on the `APP['frost-page-title'].defaultTitle` property in `config/environment.js`. Then __replace the title tag with the content-for helper__ the app's index.html, as the title will be set on build by the initializer.
```
// package.json
...
  "ember-frost-page-title": "*"
...
```
```
// config/environment.js
...
	APP: {
    'frost-page-title': {
      'defaultTitle': 'My App'
      'delimiter': 'üç∫'
      ...
    }
  }
...
```
```
// app/index.html - remove title tag
...
- <title>My App</title>
+ <title>{{content-for page-title}}</title>
...
```

## Initializers
The application initializer injects the `frost-page-title` service on an application's router. The instance initializer automatically sets up the application to use the frost-page-title-service if the `config/environment.js` file has `defaultTitle` set on the `APP['frost-page-title']` object and wrap's the router's `willTransition` and `didTransition` hooks to use the service to update the page title.

## Mixin
The frost-page-title `Mixin` provides a simple api for dynamically updating the title based on the routes that are activated in a router transition. When the `activate` hook is called on a route using the `Mixin`, if it has a `pageTitleHandler` handler function, that function will be added to an array of handlers to be called when the `Router` transitions. Each handler is called with an array of title sections generated by the last `pageTitleHandler` handler that was called and the default title. If no parent route has a handler, its handler will be passed the result of the `defaultHandler`. Likewise, this function should return an array of title sections. The result of the last handler called will be used by the service to update the page title. These custom handlers are cleaned up on the `deactivate` hook.
```
// my-route.js
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    // will simply append 'My Route' to the title
    sections.push('My Route')
    return sections	   
  }
...
})
```

## Service
The service provides a `defaultHandler` and an `updateTitle` method for updating the page title, as well as `addHandler` and `removeHandler` methods for adding/removing handlers to be run when the `Router` transitions.

### Default Handler
The `defaultHandler` method takes a url (defaulted to `window.location.hash` or `window.location.pathname`, splits it on each `/`, discards anything that doesn't look like words, converting each `-` into a space and capitalizing each word. Example: `/myapp/#/foo-bar/baz` would become `['foo bar', 'baz']`, which the update method would convert to a page title of `Foo Bar | Baz`.

### #updateTitle()
The `updateTitle` function runs runs the `defaultHandler` and the handlers built up by routes using the mixin and joins them with either a "|" or whatever you set in your config for `APP['frost-page-title'].delimiter` (see example above).

## Details page title factory util
Provided with this addon is a util that handles the default behavior for our details pages. They typically get the title from a display attribute in the model, and append the name of the currently selected tab (automatically capitalized and de-deasherized). For example:

```
// some route

import pageTitleFactory from 'ember-frost-page-title/utils/details-page-title-factory'
...
  pageTitleHandler: pageTitleFactory('displayData.displayTitle')
...
```

So if your url is /somethings-details/selectedTabId=secret-details, and your data looks like this:

```
{
  displayData: {
    'Some thing'
  }
}
```

Your title will be `Some thing | Secret details`

## Examples

### Default
```
// config/environment.js
...
	APP: {
    'frost-page-title': {
      'defaultTitle': 'My App'
      ...
    }
  }
...
```
Example Routes:

| Url | Title |
| --- | ----- |
| /myapp/#/foo/bar | Foo \| Bar |
| /myapp/#/ | My App |

### Override Default Behavior
```
// config/environment.js
...
	APP: {
    'frost-page-title': {
      'defaultTitle': 'My App'
      ...
    }
  }
...
```
```
// app/pods/application/route.js
// use top level route to override everywhere
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    // special url mapping
    const sections = window.location.hash.split('/')
    return sections.map(section => section.reverse)
  }
...
})
```
Example Routes:

| Url | Title |
| --- | ----- |
| /myapp/#/foo/bar | oof \| rab |
| /myapp/#/ | My App |

### Additive Nested Titles

```
// config/environment.js
...
	APP: {
    'frost-page-title': {
      'defaultTitle': 'My App'
      ...
    }
  }
...
```
```
// app/pods/parent/route.js
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    return [defaultTitle, 'Parent']
  }
...
})
```
```
// app/pods/child/route.js
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    return sections.concat(['Child'])
  }
...
})
```
Example Routes:

| Url | Title |
| --- | ----- |
| /myapp/#/parent | My App \| Parent |
| /myapp/#/parent/child | My App \| Parent \| Child |
| /myapp/#/ | My App |

### Override from Nested Route

```
// config/environment.js
...
	APP: {
    'frost-page-title': {
      'defaultTitle': 'My App'
      ...
    }
  }
...
```
```
// app/pods/parent/route.js
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    return [defaultTitle, 'Parent']
  }
...
})
```
```
// app/pods/child/route.js
import FrostPageTitleMixin from 'ember-frost-page-title/mixins/frost-page-title'
...
export default Route.extend(FrostPageTitleMixin, {
...
  pageTitleHandler (sections, defaultTitle) {
    return ['The Title is Mine!']
  }
...
})
```
Example Routes:

| Url | Title |
| --- | ----- |
| /myapp/#/parent | My App \| Parent |
| /myapp/#/parent/child | The Title is Mine! |
| /myapp/#/ | My App |
